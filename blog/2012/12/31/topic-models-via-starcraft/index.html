
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Topic Models via Starcraft - Bayesian World</title>
  <meta name="author" content="duckworthd">

  
  <meta name="description" content="Today, I&#8217;d like to explain to you how Topic Models work, and I will do so via a
running Starcraft example. How are these two related? Well let &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://duckworthd.github.com/blog/2012/12/31/topic-models-via-starcraft">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/data-table.css" media="screen, projection" rel="stylesheet" type="text/css" />
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Bayesian World" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Bayesian World</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:duckworthd.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about.html">About</a></li>
  <li><a href="http://twitter.com/#!/duck">Twitter</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Topic Models via Starcraft</h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-12-31T20:33:00-08:00" pubdate data-updated="true">Dec 31<span>st</span>, 2012</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>Today, I&#8217;d like to explain to you how Topic Models work, and I will do so via a
running Starcraft example.  How are these two related? Well let&#8217;s find out!</p>

<h2>Step 1: Mixture Models</h2>

<p>Before we jump into full-on Topic Models, let&#8217;s start with the basic Mixture
Model.  Imagine a High Templar commanding a battalion of Dark Templar (for the
glory of Aiur!) tasked with invading an unsuspecting Terran planet.  Luckily,
this is not the first time the Protoss have visited this planet, and Pylons are
already in place, meaning his troops need only teleport in.  However, these
Pylons were placed thousands of years ago, and while they are still in working
order, attempting to teleport a unit to one results in them being placed in the
vicinity of the Pylon, rather than right next to it.  Some Pylons are in a
better state of repair than others, so depending on which Pylon is used, he may
have a better chance of putting his Dark Templar where he intends.  In
addition, some Pylons are closer to key Terran infrastructure than others, so
simply choosing the Pylon in the best state of repair isn&#8217;t the best idea.</p>

<p>The High Templar devises a plan to surprise the Terran planet by grouping his
Dark Templar troops into squads and teleporting each squad to the same Pylon.
Being cloaked, however, only Dark Templar at the same Pylon will be able to see
and communicate with each other.  To make the best use of his forces, he
divvies up his troops into squads of the appropriate size and begins the
teleportation sequence.  After that, they are on their own.</p>

<p><img class="center" src="/images/starcraft/map-1.jpg"></p>

<p>Meanwhile, a traitorous Terran-friendly Archon watches silently from his ship
orbiting the planet.  Telepathically he senses the location of each Dark
Templar and of the re-activated Pylons, but is unable to sense which squad each
Dark Templar belongs to or the state of each Pylon.  To best help his Terran
allies, he must identify both.  Were he to know which squad each Dark Templar
belongs to, he would be able to estimate the functionality of each Pylon.  On
the other hand, if he knew how well each Pylon were working, then he would be
better able to guess which Dark Templar came from which Pylon.</p>

<p><img class="center" src="/images/starcraft/map-2.jpg"></p>

<p>The problem of seeing data points (Dark Templar positions) that you <em>know</em>
belong to individual clusters (squads) but not being able to directly observe
which cluster (squad) each data point (unit position) belongs to is precisely
what the Mixture Model assigns probabilities to.  Another way of putting it is
that the High Templar selects one of his Dark Templar subordinates uniformly at
random, chooses which Pylon to assign him to randomly with probability
proportional to what percentage of his troops he wants to allocate there, then
when the Dark Templar is teleported, his location is randomly sampled based on
the strength of the Pylon he is using.  We can write the probability of the
placement and squad assignments of all units as follows,</p>

<p>$$ P(p_{1:n_{unit}}, s_{1:n_{unit}}, \theta_{1:k} | w_{1:k}) = \prod_{j=1}^{k} P(\theta_j) \prod_{i=1}^{n} P(s_i | w_{1:k}) P(p_i | \theta_{s_i}) $$</p>

<table>
  <tr>
    <td> $p_i$ </td>
    <td> position of Dark Templar $i$ </td>
  </tr>
  <tr>
    <td> $s_i$ </td>
    <td> squad number of Dark Templar $i$ </td>
  </tr>
  <tr> 
    <td> $\theta_j$ </td>
    <td> parameters for probability distribution of position of a Dark Templar given he is assigned to Pylon $j$ </td>
  </tr>
  <tr>
    <td> $w_{j}$ </td>
    <td> probability of sending a Dark Templar to Pylon $j$ </td>
  </tr>
  <tr>
    <td> $n_{unit}$ </td>
    <td> number of Dark Templar </td>
  </tr>
  <tr>
    <td> $k$ </td>
    <td> number of Pylons </td>
  </tr>
</table>


<p>Once we assume the above probability distribution, we can use one of a variety
of algorithm for Probabilistic Inference to find
$P(s_{1:n} , \theta_{1:k} | p_{1:n})$, giving us a good guess as to which
cluster each data point belongs to and how strong each Pylon is.</p>

<h2>Step 2: Topic Models</h2>

<p>Back to our example, let&#8217;s now extend the Mixture Model to a full Topic Model.
Suppose now that the traitorous Archon is not just any Archon, but a Dark
Archon gifted with the ability to observe the outcome of many alternative
universes.  In each alternative universe, the High Templar chooses different
proportions of his units to assign to each squad and each unit&#8217;s position ends
up being different, but the behavior of each Pylon remains unchanged.  The Dark
Archon&#8217;s power is limited however, and he can only observe a finite number of
different universes before exhausting his energy.  While the outcome of each
alternative universe cannot help him figure out which Dark Templar is assigned
to which Pylon directly in this universe, it can help him figure out how each
Pylon behaves.  In addition, the Dark Archon gets a better idea of how the
opposing High Templar will assign his Dark Templar as the strategic value of
each Pylon remains the same.</p>

<p><img class="center" src="/images/starcraft/map-1.jpg">
<img class="center" src="/images/starcraft/map-3.jpg">
<img class="center" src="/images/starcraft/map-4.jpg"></p>

<p>The problem I have just described is precisely that modeled by Latent Dirichlet
Allocation, the most basic Probabilistic Topic Model. Each universe is that of
a single &#8220;document&#8221;, with its own unobserved document-cluster weights
(proportions).  Within each universe, there exists a Mixture Model, but with a
twist &#8211; all universes (documents) share the same cluster (Pylon) parameters.
To put it mathematically,</p>

<p>$$ P(p_{1:n_{doc},1:n_{unit}}, s_{1:n_{doc},1:n_{unit}}, w_{1:n_{doc}, 1:k}, \theta_{1:k}) $$
$$ = P(\alpha) \prod_{j=1}^{k} P(\theta_{j}) \prod_{l=1}^{n_{doc}} P(w_{l, 1:k} | \alpha) \prod_{i=1}^{n_{unit}} P(s_{l,i} | w_{l, 1:k}) P(p_{l,i} | \theta_{s_{l,i}}) $$</p>

<table>
  <tr>
     <td> $p_{l,i}$ </td>
     <td> position of $i$-th Dark Templar in $l$-th universe </td>
  </tr>
  <tr>
     <td> $s_{l,i}$ </td>
     <td> squad number of $i$-th Dark Templar in $l$-th universe </td>
  </tr>
  <tr>
     <td> $w_{l,j}$ </td>
     <td> probability of sending a Dark Templar to Pylon $j$ in universe $l$ </td>
  </tr>
  <tr>
     <td> $\theta_{j}$ </td>
     <td> parameters for probability distribution of position of a Dark Templar given he is assigned to Pylon $j$ </td>
  </tr>
  <tr>
     <td> $\alpha$ </td>
     <td> parameters for probability distribution over universe-specific proportions </td>
  </tr>
  <tr>
     <td> $n_{doc}$ </td>
     <td> number of universes </td>
  </tr>
  <tr>
     <td> $n_{unit}$ </td>
     <td> number of Dark Templar units </td>
  </tr>
  <tr>
     <td> $k$ </td>
     <td> number of Pylons </td>
  </tr>
</table>


<p>Once again, once we assume the above probability distribution, we can use
Probabilistic Inference to find a good estimate for the parameters common to
every universe &#8211; $\alpha$ and $\theta_{1:k}$.</p>

<h2>Epilogue</h2>

<p>To summarize, Topic Models are simply a probabilistic model assigning
probabilities to multiple-universe Mixture Models.  So how do  &#8220;topics&#8221; fit
into all of this?  Recall earlier that I described each universe as a
&#8220;document&#8221; &#8211; there&#8217;s a good reason for this. In the original Latent Dirichlet
Allocation paper, the goal wasn&#8217;t to figure out which squads Dark Templars are
assigned to but rather which &#8220;topics&#8221; individual words in articles were part
of.  The intuition is that when you&#8217;re talking about a particular topic (e.g.
sports, wallabees, or Cards Against Humanity), there is a distinctive
probability distribution over words you would use, separate from every other
topic.  Keep in mind that nothing about the model includes human supervision &#8211;
what the model thinks is a likely set of &#8220;topics&#8221; may not correspond to
anything we as readers identify as meaningful.  However, in practice some
rather interesting &#8220;topics&#8221; pop up, so a cottage research field has spent the
last 10+ years trying to extend Latent Dirichlet Allocation to better capture
the &#8220;topics&#8221; we as humans find &#8220;nice&#8221;.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">duckworthd</span></span>

      








  


<time datetime="2012-12-31T20:33:00-08:00" pubdate data-updated="true">Dec 31<span>st</span>, 2012</time>
      


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://duckworthd.github.com/blog/2012/12/31/topic-models-via-starcraft/" data-via="duck" data-counturl="http://duckworthd.github.com/blog/2012/12/31/topic-models-via-starcraft/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2012/05/10/the-limits-of-bayesian-networks/" title="Previous Post: The Limits of Bayesian Networks">&laquo; The Limits of Bayesian Networks</a>
      
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2012/12/31/topic-models-via-starcraft/">Topic Models via Starcraft</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/05/10/the-limits-of-bayesian-networks/">The Limits of Bayesian Networks</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/05/10/sparse-features-and-l2-regularization/">Sparse Features and L2 Regularization</a>
      </li>
    
  </ul>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("duck", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/duck" class="twitter-follow-button" data-show-count="false">Follow @duck</a>
  
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - duckworthd -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>






  <!-- mathjax config similar to math.stackexchange -->
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    jax: ["input/TeX", "output/HTML-CSS"],
    tex2jax: {
      inlineMath: [ ['$', '$'] ],
      displayMath: [ ['$$', '$$']],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    messageStyle: "none",
    "HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] }
  });
  </script>
  <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
</body>
</html>
